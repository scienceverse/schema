{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://scienceverse.org/schema/paper.json",
  "title": "Bibr Paper",
  "description": "A research paper, as processed by bibr",
  "type": "object",
  "properties": {
    "id": {
      "description": "A unique ID for each paper (usually the bibr file_hash)",
      "type": ["string", "null"]
    },
    "info": {
      "description": "A table of information about the paper",
      "type": "object",
      "properties": {
        "title": { "type": "string" }, 
        "description": { "type": ["string", "null"] }, 
        "keywords": {
          "type": "array",
          "items": { "type": "string" }
        }, 
        "doi": { 
          "type": ["string", "null"],
          "pattern": "^10\\.\\d{4,9}/\\S+$"
        }, 
        "file_hash": { 
          "type": "string", 
          "pattern": "^[a-f0-9]{14}$"
        },
        "input_format": {
          "type": "string",
          "enum": [
            "pdf",
            "html",
            "docx",
            "doc",
            "md",
            "unknown"
          ]
        }, 
        "file_name": {  "type": "string" }, 
        "bibr_version": { "type": "string" }, 
        "paper_type": {
          "type": "string",
          "enum": [
            "empirical",
            "unknown"
          ]
        }, 
        "paper_type_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }, 
        "oecd_l1": {
          "description": "OECD Research Area, Level 1",
          "type": ["string", "null"],
          "enum": [
            "Natural Sciences",
            "Engineering and Technology",
            "Medical and Health Sciences",
            "Agricultural and Veterinary Sciences",
            "Social Sciences",
            "Humanities and the arts"
          ]
        }, 
        "oecd_l2": {
          "description": "OECD Research Area, Level 2",
          "type": ["string", "null"],
          "enum": [
            "Mathematics",
            "Computer and information sciences",
            "Physical sciences",
            "Chemical sciences",
            "Earth and related environmental sciences",
            "Biological sciences",
            "Other natural sciences",
            "Civil engineering",
            "Electrical engineering, electronic engineering, information engineering",
            "Mechanical engineering",
            "Chemical engineering",
            "Materials engineering",
            "Medical engineering",
            "Environmental engineering",
            "Environmental biotechnology",
            "Industrial biotechnology",
            "Nano-technology",
            "Other engineering and technologies",
            "Basic medical research",
            "Clinical medicine",
            "Health sciences",
            "Medical biotechnology",
            "Other medical science",
            "Agriculture, forestry, fisheries",
            "Animal and dairy science",
            "Veterinary science",
            "Other agricultural science",
            "Psychology and cognitive science",
            "Economics and business",
            "Educational sciences",
            "Sociology",
            "Law",
            "Political science",
            "Social and economic geography",
            "Media and communication",
            "Other social sciences",
            "History and archeology",
            "Languages and literature",
            "Philosophy, ethics and religion",
            "Art",
            "Other Humanities"
          ]
        }, 
        "oecd_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      },
      "required": ["title", "description", "keywords", "doi", "file_hash", 
"input_format", "file_name", "bibr_version", "paper_type", "paper_type_confidence", 
"oecd_l1", "oecd_l2", "oecd_confidence"],
      "additionalProperties": false
    },
    "authors": {
      "type": "array",
      "items": { "$ref": "#/$defs/author" }
    },
    "text": {
      "type": "array",
      "items": { "$ref": "#/$defs/sentence" }
    },
    "sections": {
      "type": "array",
      "items": { "$ref": "#/$defs/section" }
    },
    "links": {
      "type": "array",
      "items": { "$ref": "#/$defs/link" }
    },
    "bib": {
      "type": "array",
      "items": { "$ref": "#/$defs/bibentry" }
    },
    "xrefs": {
      "type": "array",
      "items": { "$ref": "#/$defs/xref" }
    },
    "figs": {
      "type": "array",
      "items": { "$ref": "#/$defs/fig" }
    },
    "tbls": {
      "type": "array",
      "items": { "$ref": "#/$defs/tbl" }
    }
  },

  "required": [
    "id",
    "info",
    "authors", 
    "text",
    "sections",
    "links",
    "bib",
    "xrefs",
    "figs",
    "tbls"
  ],

  "additionalProperties": false,
  
  "$defs": {
    "author": {
      "type": "object",
      "properties": {
        "author_id": { "type": "integer" }, 
        "given": { "type": ["string", "null"] }, 
        "family": { "type": ["string", "null"] }, 
        "affiliation": { "type": ["string", "null"] }, 
        "email": { 
          "type": ["string", "null"],
          "format": "email"
        }, 
        "corresponding": { "type": "boolean" }, 
        "orcid": { 
          "type": ["string", "null"],
          "pattern": "^\\d{4}-\\d{4}-\\d{4}-\\d{3}[\\dX]$" 
        }, 
        "role": { 
          "type": "array",
          "items": { "type": ["string", "null"] }
        }
      },
      "required": [ 
        "author_id", 
        "given", 
        "family", 
        "affiliation", 
        "email", 
        "corresponding", 
        "orcid"
      ]
    },
    "sentence": {
      "type": "object",
      "properties": {
        "text_id": { "type": "integer" },
        "section_id": { "type": "integer" },
        "paragraph_id": { "type": "integer" },
        "text": { "type": "string" }
      },
      "required": ["text_id", "section_id", "paragraph_id", "text"]
    },
    "section": {
      "type": "object",
      "properties": {
        "section_id": { "type": "integer" },
        "header": { "type": "string" },
        "parent_section_id": { "type": "integer" }, 
        "section_type": { 
          "type": "string",
          "enum": [
            "abstract",
            "intro",
            "method",
            "results",
            "discussion",
            "references",
            "acknoweldegment",
            "funding",
            "endnote",
            "footnote",
            "unknown"
          ]
        }, 
        "classification_score": { 
          "type": "number", 
          "minimum": 0,
          "maximum": 1
        }
      },
      "required": ["section_id", 
                   "header", 
                   "parent_section_id", 
                   "section_type", 
                   "classification_score"]
    },
    "link": {
      "type": "object",
      "properties": {
        "url": { 
          "type": "string", 
          "format": "uri" 
        },
        "link_text": { "type": ["string", "null"] },
        "text_id": { "type": "integer" }
      },
      "required": ["url", "link_text", "text_id"]
    },
    "bibentry": {
      "type": "object",
      "properties": {
        "bib_id": { "type": "integer" }, 
        "title": { "type": "string" }, 
        "first_page": { "type": "string" }, 
        "volume": { "type": "string" }, 
        "author": { "type": "string" }, 
        "year": { "type": "integer" }, 
        "journal_title": { "type": "string" }, 
        "isbn": { "type": "string" }, 
        "doi": { 
          "type": "string",
          "pattern": "^10\\.\\d{4,9}/\\S+$"
        }, 
        "bibtype": { "type": "string" }, 
        "bib_text": { "type": "string" }, 
        "last_page": { "type": "string" }, 
        "issue": { "type": "string" }, 
        "editor": { "type": "string" }, 
        "publisher": { "type": "string" }, 
        "issn": { "type": "string" }, 
        "link": { "type": "string" }, 
        "crossref_verified": { "type": "boolean" }, 
        "crossref_match": { "type": "string" }, 
        "crossref_score": { "type": "number" }
      },
      "required": ["bib_id", "bib_text"]
    },
    "xref": {
      "type": "object",
      "properties": {
        "xref_id": { "type": "integer" }, 
        "xref_type": { 
          "type": "string",
          "enum": [
            "bib",
            "tbl",
            "fig"
          ]
        }, 
        "contents": { "type": "string" }, 
        "text_id": { "type": "integer" }
      },
      "required": ["xref_id", "xref_type", "contents", "text_id"]
    },
    "tbl": {
      "type": "object",
      "properties": {
        "tbl_id": {
          "description": "A unique ID for each table",
          "type": ["integer", "null"]
        },
        "caption": {
          "description": "The table caption",
          "type": ["string", "null"]
        },
        "contents": {
          "description": "The table contents as tabular data",
          "type": ["array", "null"],
          "items": {
            "type": "array",
            "items": { "type": ["string", "number", "boolean", "null"] }
          }
        }
      },
      "required": [ "tbl_id", "caption", "contents"]
    },
    "fig": {
      "type": "object",
      "properties": {
        "fig_id": {
          "description": "A unique ID for each figure",
          "type": ["integer", "null"]
        },
        "caption": {
          "description": "The figure caption",
          "type": ["string", "null"]
        },
        "image": {
          "description": "The base64 image or reference to it (undecided)",
          "type": ["string", "null"]
        }
      },
      "required": [ "fig_id", "caption", "image"]
    }
  }
}

